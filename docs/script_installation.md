## Інсталяція за допомогою скрипта автоматичного встановлення

Для автоматизації процесу встановлення та подальшої роботи вебсервісу було створено скрипти `deploy.sh` та `deploy_by_gunicorn.sh`. 
Cкрипт `deploy.sh` встановлює та запускає вебсервыс у однопоточному режимі за допомогою Python. Цей варіант встановлення підходить лише для тестування та дуже детальної відладки вебсервісу. Скрипт `deploy_by_gunicorn.sh` встановлює та запускає вебсервіс у багатопоточному режимі за допомогою WSGI серверу Gunicorn. Це варіант є сумісним з системою «Трембіта», та є значно продуктивнішим рішенням.

**Дані скрипти:**
1. Встановлюють системні залежності.
2. Клонують репозиторій.
3. Створюють та активують віртуальне середовище.
4. Встановлюють залежності Python.
5. Встановлюють СУБД MariaDB.
6. Налаштовуть конфігурацію бази даних.
7. Створюють структуру бази даних за допомогою Alembic.
8. Створюють систему управління службами systemd для запуску вебсервісу.


**Для того, щоб встановити даний вебсервіс за допомогою скрипта `deploy_by_gunicorn.sh` необхідно:**

1. Додати репозиторій з Python3.10:
2. 
```bash
sudo add-apt-repository ppa:deadsnakes/ppa
```

2. Завантажити скрипт:
```bash
wget https://raw.githubusercontent.com/kshypachov/soap_sync_service/master/deploy_by_gunicorn.sh
```

3. Відредагувати скрипт «deploy_by_gunicorn.sh», замінивши значення параметрів `DB_USER`, `DB_PASSWORD`, `DB_NAME`, `DB_HOST` та `DB_PORT` на ваші реальні дані, де:

• [DB_NAME] – назва БД;

• [DB_USER] – логін користувача БД;

• [DB_PASSWORD] – пароль для даного користувача;

• [DB_HOST] – ІР-адреса хоста, на якому знаходиться база даних;

• [DB_PORT] – порт для підключення до БД.

4. Зробити файл виконуваним:
```bash
chmod +x deploy_by_gunicorn.sh
```

5. Запустити скрипт:

```bash
./deploy_by_gunicorn.sh
```

Після закінчення роботи скрипта сервіс буде автоматично запущено та додано до автозапуску.

**Для того, щоб встановити даний вебсервіс за допомогою скрипта «deploy.sh» необхідно:**
1. Додати репозиторій з Python3.10:
```bash
sudo add-apt-repository ppa:deadsnakes/ppa
```
2. Завантажити скрипт:
```bash
wget https://raw.githubusercontent.com/kshypachov/soap_sync_service/master/deploy.sh
```

3. Відредагувати скрипт «deploy_by_gunicorn.sh», замінивши значення параметрів `DB_USER`, `DB_PASSWORD`, `DB_NAME`, `DB_HOST` та `DB_PORT` на ваші реальні дані, де:

• [DB_NAME] – назва БД;

• [DB_USER] – логін користувача БД;

• [DB_PASSWORD] – пароль для даного користувача;

• [DB_HOST] – ІР-адреса хоста, на якому знаходиться база даних;

• [DB_PORT] – порт для підключення до БД.

4. Зробити файл виконуваним:
```bash
chmod +x deploy.sh
```
5. Запустити скрипт:
```bash
./deploy.sh
```
Після закінчення роботи скрипта сервіс буде автоматично запущено та додано до автозапуску

Конфігурування вебсервісу здійснюється автоматично. 
Детально з інформацією щодо конфігураційних файлів можна ознайомитися в [настановах з конфігурації](./configuration.md).

##
Матеріали створено за підтримки проєкту міжнародної технічної допомоги «Підтримка ЄС цифрової трансформації України (DT4UA)».

